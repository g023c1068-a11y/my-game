<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Leaderboard Game</title>
    <style>
        /* CSSã§ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã¨ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æ•´ãˆã‚‹ */
        body { text-align: center; font-family: sans-serif; }
        #game-area { display: inline-block; margin-right: 20px; }
        #leaderboard-area { display: inline-block; vertical-align: top; width: 300px; padding: 10px; border: 1px solid #ccc; }
        #score-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        #score-table th, #score-table td { border: 1px solid #ddd; padding: 8px; }
    </style>
</head>
<body>

    <div id="game-area">
        <div id="unity-container" class="unity-desktop">
            <canvas id="unity-canvas" width=960 height=600></canvas>
        </div>
        </div>

    <div id="leaderboard-area">
        <h2>ğŸ† ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰</h2>
        <table id="score-table">
            <thead>
                <tr><th>Rank</th><th>Name</th><th>Score</th></tr>
            </thead>
            <tbody id="leaderboard-body">
                <tr><td>-</td><td>Loading...</td><td>-</td></tr>
            </tbody>
        </table>
    </div>

    <script src="Build/MyGame.loader.js"></script> 

    <script>
        // ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚„è¨­å®šã‚’å®šç¾© (Unityã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ˆã£ã¦ãƒã‚¯ãƒ­ç½®æ›ã•ã‚Œã‚‹)
        var buildUrl = "Build";
        var loaderUrl = buildUrl + "/MyGame.loader.js";
        var config = {
            dataUrl: buildUrl + "/MyGame.data.unityweb",
            frameworkUrl: buildUrl + "/MyGame.framework.js.unityweb",
            codeUrl: buildUrl + "/MyGame.wasm.unityweb",
            // ãã®ä»–ã®è¨­å®š...
        };

        var unityContainer = document.querySelector("#unity-container");
        var canvas = document.querySelector("#unity-canvas");
        var loadingBar = document.querySelector("#unity-loading-bar"); // Optional

        // ã‚²ãƒ¼ãƒ ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
        createUnityInstance(canvas, config, (progress) => {
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é€²æ—ã®å‡¦ç† (çœç•¥)
        }).then((unityInstance) => {
            // æˆåŠŸ: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜ã—ã¦ãŠãã¨ã€å¾Œã§Unityé–¢æ•°ã‚’å‘¼ã³å‡ºã™ã®ã«ä¾¿åˆ©
            window.unityGameInstance = unityInstance;
            
            // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å–å¾—ãƒ»è¡¨ç¤ºã™ã‚‹é–¢æ•°ã‚’å‘¼ã³å‡ºã™
            fetchLeaderboard(); 

        }).catch((message) => {
            console.error("Unity failed to load:", message);
        });

        // ----------------------------------------------------
        // â˜… ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰é–¢é€£ã®ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°
        // ----------------------------------------------------

        // å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€HTMLã«è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function fetchLeaderboard() {
            // â˜…å®Ÿéš›ã«ã¯ã€ã“ã“ã§ã‚µãƒ¼ãƒãƒ¼APIã‚’å‘¼ã³å‡ºã™ (ä¾‹: fetch('YOUR_API_ENDPOINT/scores'))
            
            // === [ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿] ===
            const scores = [
                { rank: 1, name: "Alice", score: 12500 },
                { rank: 2, name: "Bob", score: 9800 },
                { rank: 3, name: "Char", score: 7500 }
            ];
            // ==================

            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = ''; // ä¸€æ—¦ã‚¯ãƒªã‚¢

            scores.forEach(s => {
                const row = tbody.insertRow();
                row.insertCell().textContent = s.rank;
                row.insertCell().textContent = s.name;
                row.insertCell().textContent = s.score.toLocaleString();
            });
        }

        // Unity (C#) ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹JavaScripté–¢æ•°
        // Unityå´ã§ã¯ [DllImport("__Internal")] public static extern void SubmitScore(string name, int score); ã¨é€£æº
        window.SubmitScoreToWeb = function(name, score) {
            console.log("Score received from Unity:", name, score);
            // â˜…å®Ÿéš›ã«ã¯ã€ã“ã“ã§ã‚¹ã‚³ã‚¢ã‚’ã‚µãƒ¼ãƒãƒ¼APIã«POSTã™ã‚‹ (ä¾‹: fetch('YOUR_API_ENDPOINT/submit', { method: 'POST', body: JSON.stringify(...) }))
            
            // ã‚¹ã‚³ã‚¢é€ä¿¡å¾Œã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å†å–å¾—
            fetchLeaderboard();
        }

    </script>
</body>
</html>
