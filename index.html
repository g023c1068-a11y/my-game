<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>My Unity Game with Leaderboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #222;
      color: #fff;
      font-family: sans-serif;
      overflow: hidden; /* âœ… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¦æ­¢ */
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    /* ä¸Šéƒ¨ï¼šUnityã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ï¼ˆå…¨ä½“ã®70%é«˜ã•ï¼‰ */
    #unity-container {
      width: 100%;
      max-width: 960px;
      height: 70vh; /* âœ… ç”»é¢ã®7å‰²ã‚’Unityç”¨ã«ç¢ºä¿ */
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 10px;
    }

    canvas {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* ä¸‹éƒ¨ï¼šãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ï¼ˆå…¨ä½“ã®30%é«˜ã•ï¼‰ */
    #leaderboard-area {
      width: 100%;
      max-width: 960px;
      height: 28vh; /* âœ… ç”»é¢ã®3å‰²å¼±ã«å›ºå®š */
      background: #333;
      border-radius: 10px;
      margin-top: 10px;
      padding: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
    }

    #leaderboard-area h2 {
      margin: 0;
      text-align: center;
      font-size: 1.2em;
    }

    #score-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      flex-grow: 1;
    }

    #score-table th, #score-table td {
      border: 1px solid #555;
      padding: 5px;
      text-align: center;
      font-size: 0.9em;
    }

    #score-table th {
      background: #444;
    }
  </style>
</head>
<body>
  <!-- Unityã‚²ãƒ¼ãƒ éƒ¨åˆ† -->
  <div id="unity-container">
    <canvas id="unity-canvas"></canvas>
  </div>

  <!-- ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰éƒ¨åˆ† -->
  <div id="leaderboard-area">
    <h2>ğŸ† ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰</h2>
    <table id="score-table">
      <thead>
        <tr><th>Rank</th><th>Name</th><th>Score</th></tr>
      </thead>
      <tbody id="leaderboard-body">
        <tr><td>-</td><td>Loading...</td><td>-</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    // --- Unityã®è¨­å®š ---
    const buildUrl = "Build";
    const loaderUrl = buildUrl + "/Build.loader.js";
    const config = {
      dataUrl: buildUrl + "/Build.data.unityweb",
      frameworkUrl: buildUrl + "/Build.framework.unityweb",
      codeUrl: buildUrl + "/Build.wasm.unityweb",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "YourCompany",
      productName: "My Unity Game",
      productVersion: "1.0",
      showBanner: (msg, type) => console.log(type + ": " + msg)
    };

    const canvas = document.querySelector("#unity-canvas");

    // Unityã®ãƒ­ãƒ¼ãƒ‰å‡¦ç†
    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
      createUnityInstance(canvas, config, (progress) => {
        console.log("Loading: " + (progress * 100).toFixed(1) + "%");
      }).then((unityInstance) => {
        console.log("âœ… Unity Game Loaded!");
        window.unityGameInstance = unityInstance;

        // èµ·å‹•æ™‚ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º
        fetchLeaderboard();
      }).catch((message) => {
        alert("âŒ Unity èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: " + message);
      });
    };
    document.body.appendChild(script);

    // --- ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰å‡¦ç† ---
    function fetchLeaderboard() {
      const scores = [
        { rank: 1, name: "Alice", score: 12500 },
        { rank: 2, name: "Bob", score: 9800 },
        { rank: 3, name: "Char", score: 7500 }
      ];

      const tbody = document.getElementById('leaderboard-body');
      tbody.innerHTML = '';
      scores.forEach(s => {
        const row = tbody.insertRow();
        row.insertCell().textContent = s.rank;
        row.insertCell().textContent = s.name;
        row.insertCell().textContent = s.score.toLocaleString();
      });
    }

    window.SubmitScoreToWeb = function(name, score) {
      console.log("Score received from Unity:", name, score);
      fetchLeaderboard();
    }
  </script>
</body>
</html>
